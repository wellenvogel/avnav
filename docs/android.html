<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>AvNav-Android</title>
    <link href="styles.css" rel="stylesheet" type="text/css">
  </head>
  <body data-order="4000">
    <h1>AvNav Android</h1>
    <p>Nachdem die Navigations-App für die <a href="beschreibung.html">Nutzung
        mit dem Raspberry Pi</a>&nbsp; bereits einige Jahre erfolgreich im
      Einsatz ist, gibt es jetzt auch eine Version, die direkt (ohne einen
      Raspberry) auf Android läuft. Sie erfordert Android ab 4.4 (KitKat).</p>
    <p>Die aktuellste Version kann man unter <a href="../downloads/release/latest">Downloads</a>
      herunterladen. Oder im <a href="https://play.google.com/store/apps/details?id=de.wellenvogel.avnav.main">AppStore</a>.<br>
      Ältere Versionen oder daily builds findet man über die <a href="install.html">Installationsbeschreibung</a>.</p>
    <p>Sie verpackt im Wesentlichen die Web-App (siehe <a href="userdoc/index.html">Beschreibung</a>)
      in eine Android Applikation - siehe dort auch zum <a href="charts.html">Erzeugen/Konvertieren</a>
      der Karten.</p>
    <p>Es kann das interne GPS des Gerätes genutzt werden. Alternativ können
      NMEA Daten über TCP/IP, bluetooth oder einen USB-Seriell-Adapter
      (erfordert USB-OTG) empfangen werden. Die Quelle dafür kann z.B. ein
      Raspberry mit meiner Software sein - aber auch ein beliebiger anderer
      Sender, der die NMEA Daten per WLAN bereitstellt. Auch eine einfache GPS
      bluetooth "Maus" ist geeignet.</p>
    <p>Damit kann die Software auch auf Tablets ohne eingebautes GPS laufen.</p>
    <p>Die Karten werden im gemf <a href="charts.html#chartformats">Format</a>
      erwartet.Ab Version 20200325 auch als mbtiles oder xml files. Sie können
      in 2 Verzeichnissen liegen:</p>
    <ul>
      <li> im charts Verzeichnis unterhalb des Arbeitsverzeichnisses (kann beim
        Start gewählt werden). Dieses muß beschreibbar sein und wird daher bei
        Android 4.4 und höher auf dem internen Speicher liegen müssen</li>
      <li>in einem beliebigen anderen Verzeichnis (vorzugsweise auf der SD
        Karte) - "additional charts dir" in den Einstellungen<br>
        Hier können allerdings keine mbtiles Karten genutzt werden, diese müssen
        erst in das interne Verzeichnis <a href="userdoc/downloadpage.html">hochgeladen</a>
        werden.</li>
    </ul>
    <p>Die Karten müssen auf das Gerät in eines der Verzeichnisse kopiert werden
      . Zusätzlich sind einige Demo-Karten vorhanden, die allerdings eine
      Online-Verbindung erfordern.</p>
    <p>Wenn das gewählte Arbeitsverzeichnis&nbsp; (Standard:
      interne-sd-Karte/avnav) noch nicht da ist, wird es beim ersten Start
      angelegt.</p>
    <p>Die Track-Daten und logs werden in das Verzeichnis tracks unterhalb des
      Arbeitsverzeichnisses geschrieben.</p>
    <p>Im Unterverzeichnis routes werden die Routen im gpx Format gespeichert.
      Routen und Tracks können aus der App über die Download Funktion an andere
      Apps weitergegeben werden (siehe Beschreibung der App). Um sie in andere
      Verzeichnisse zu speichern oder Routen aus anderen Verzeichnissen zu laden
      (upload Funktion) sollte sinnvollerweise ein Dateimanager installiert
      sein.</p>
    <p>Nach dem erstmaligen Start der App befindet man sich auf einer
      Einführungsseite:</p>
    <img alt="" src="android-start-first.png" height="400"><br>
    Nach dem Klick kommt man auf die Einstellungsseite:<br>
    <img src="android-mainsettings.png" alt="" class="fimage"><br>
    Hier können z.B. die Verzeichnisse&nbsp; für Karten und Tracks gewählt
    werden, sowie die Quelle für die Positionsdaten.<br>
    Eine Liste der Settings findet sich <a href="#Settings">hier</a>.<br>
    <br>
    <p> Die Settings Seite kann über den OK button (oben rechts) oder über den
      Zurück-Button verlassen werden. Im Normalmodus erreicht man damit die <a
        href="userdoc/mainpage.html">Hauptseite</a> der App.</p>
    <img src="android-mainpage.png" alt="" class="fimage"><br>
    Im Bild ist wird eine gültige Position (oberer grüner Punkt) und bisher noch
    keine gültigen AIS Daten (unterer roter Punkt) empfangen.<br>
    Um zu den Android Einstellungen zu gelangen, zunächst die <a href="userdoc/settingspage.html">Einstellungsseite</a>
    in der App aufrufen, dort dann auf den Android Button klicken.<br>
    Bei weiteren Starts erreicht man sofort die Hauptseite der App.<br>
    <br>
    <h2>Bluetooth</h2>
    <br>
    Zum Verbinden mit einem Bluetooth GPS, dieses zunächst über die Bluetooth
    Einstellungen (ausserhalb der Applikation) "pairen".<br>
    In der App dann in den Einstellungen Bluetooth Device auswählen, es
    erscheint ein Auswahldialog für verbundene Bluetooth Geräte:<br>
    <br>
    Leider ist in älteren Android Versionen (&lt; 4.4) Bluetooth manchmal
    ziemlich fehlerbehaftet. Wenn sich partout keine Verbindung ergeben will
    (Anzeigen bleiben auf gelb, status searching Sat 0/0) hilft oft ein Neustart
    des Tablets.<br>
    Auf Nexus Geräten scheint das besser zu funktionieren als auf einigen
    anderen.<br>
    <br>
    Zum Verlassen der App auf der Haupseite den <img src="viewerimages/icons-new/ic_clear.svg"
      alt="" class="inlineimage">Button nutzen. Solange die App läuft ist auch
    die Track-Aufzeichnung aktiv (auch wenn sie nicht sichtbar ist).<br>
    <h2> Modus</h2>
    Die App kann in 2 Modi arbeiten:<br>
    <ul>
      <li>Normal</li>
      <li>External Browser</li>
    </ul>
    Im Normal-Modus ist der Browser in der App integriert und sie wird wie eine
    normale Android App genutzt.<br>
    Im External-Browser Mode startet die App einen kleinen Webserver (also
    spielt so ein wenig Raspberry...) auf einem einstellbaren Port (34567) und
    zeigt die folgende Seite an:<br>
    <img src="android-external.png" alt="" class="fimage"><br>
    <br>
    Durch einen Klick auf Start Browser wird eine Auswahl der installierten
    Browser angezeigt, hier Chrome auswählen.<br>
    Leider hat man dann im Browser immer die Adressleiste, die etwas Platz
    wegnimmt. Um das zu verhindern, kann man in Chrome im Einstellungsmenü "Zum
    Startbildschirm hinzufügen" einstellen, dann noch einen sinnvollen Namen
    vergeben .<br>
    <br>
    <img style="width: 640px; height: 400px;" alt="" src="android-chrome.png"><br>
    <br>
    Danach über den Home Button hier den Chrome Browser verlassen und auf dem
    Startbildschirm auf das neue Icon klicken.<br>
    Das sieht dann wieder gut aus:<br>
    <img style="width: 640px; height: 400px;" alt="" src="android-chrome2.png"><br>
    <br>
    Zum Beenden über die Notifikation gehen (kleines Segelboot), darüber kommt
    man wieder in die App und kann sie über die Browser-Seite&nbsp;&nbsp;
    verlassen.<br>
    Sonst laufen der GPS Empfang und das Trackschreiben im Hintergrund weiter.<br>
    Beim nächsten Start nur die App im Browser Mode starten, dann direkt über
    den Home Button zum Startbildschirm und den Browser über das abgelegte Icon
    dort starten.<br>
    Wenn in den Einstellungen-&gt;Android-&gt;MainSettings "WebServer external
    access" eingeschaltet wird, können andere Geräte im Netz auf die App
    zugreifen.<br>
    <span style="color:red">Achtung: Das sollte nur in vertrauenswürdigen Netzen
      geschehen, das es hier keinen weiteren Schutz gibt!.</span><br>
    Die App announciert ihren service per Bonjour, so das sie leicht von anderen
    gefunden werden kann. <br>
    <br>
    Wenn die App läuft werden die Track-Daten alle 5 Minuten in eine Datei
    geschrieben.<br>
    Wichtiger Hinweis:<br>
    Wenn man im Browser-Mode mal direkt aus der App und mal vom Home Bildschirm
    startet, hat man jedesmal andere Einstellungen in der App.<br>
    Also bitte immer den gleichen Weg benutzen.<br>
    <br>
    <h2> <a id="Settings" name="Settings"></a>Einstellungen</h2>
    Die folgenden Parameter können auf den Einstellungsseiten gesetzt werden<br>
    <h3>Main Settings</h3>
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td>Name</td>
          <td>Bedeutung</td>
          <td>Default</td>
        </tr>
        <tr>
          <td>Application Mode</td>
          <td>Arbeitsmodus, siehe Modus</td>
          <td>Normal</td>
        </tr>
        <tr>
          <td>working directory</td>
          <td>das Arbeitsverzeichnis (mit den Unterverzeichnissen charts,tracks,
            routes)</td>
          <td>/storage/sdcard/avnav</td>
        </tr>
        <tr>
          <td>additional charts directory</td>
          <td>ein zusätzliches Kartenverzeichnis (sinnvoll auf der externen SD
            Karte)</td>
          <td>/storage/sdcard/avnav/charts</td>
        </tr>
        <tr>
          <td>show demo charts</td>
          <td>Anzeige der Demo Karten (erfordert Internet Verbindung)</td>
          <td>ein<br>
          </td>
        </tr>
        <tr>
          <td>WebServer External Access</td>
          <td>Im External Browser Mode können andere Geräte von aussen
            zugreifen. Im Browser erreicht man dazu von der Status Seite eine <a
              href="userdoc/addresspage.html">Anzeige von QR codes</a> - wenn
            man diese mit dem anderen Gerät ausliest (typisch der 2. angezeigte)
            und sich im gleichen WLAN befindet, kann man mit dem 2. Gerät
            ebenfalls zugreifen.</td>
          <td>aus</td>
        </tr>
        <tr>
          <td>Alarm sounds</td>
          <td>Hier können die durch den Server erzeugten Alarm-Sounds
            abgeschaltet werden. Im external Browser mode müssen diese im
            Browser ggf. zusätzlich abgeschaltet werden.</td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h3> NMEA</h3>
    <table style="width: 100%;" border="1">
      <tbody>
        <tr>
          <td>Name</td>
          <td>Bedeutung</td>
          <td>Default</td>
        </tr>
        <tr>
          <td>NMEA Source</td>
          <td>Auswahl der Quelle für Positionsdaten (Off,Internal, IP,
            Bluetooth)</td>
          <td>Internal</td>
        </tr>
        <tr>
          <td>AIS Source</td>
          <td>Auswahl der Quelle für AIS Daten (Off,IP,Bluetooth)</td>
          <td>Off</td>
        </tr>
        <tr>
          <td>send own position on AIS device</td>
          <td>Wenn AIS und NMEA unterschiedliche Quellen haben, wird auf dem AIS
            channel die eigene Position (RMC) gesendet</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>IP Address</td>
          <td>IP Adresse von der NMEA/AIS Daten empfangen werden sollen</td>
          <td>192.168.10.20</td>
        </tr>
        <tr>
          <td>IP Port</td>
          <td>Port für den IP Empfang</td>
          <td>34567</td>
        </tr>
        <tr>
          <td>Bluetooth Device</td>
          <td>Auswahl des Bluetooth Gerätes</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>USB Device</td>
          <td>Auswahl eines angeschlossenen USB devices</td>
          <td style="height: 19px;"><br>
          </td>
        </tr>
        <tr>
          <td>USB Baudrate</td>
          <td>Baudrate USB</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>filter own MMSI</td>
          <td>hier kann die eigene MMSI eingetragen werden, wenn der AIS
            Empfänger diese mit ausgibt, die Daten werden dann ignoriert</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>filter incoming NMEA</td>
          <td>hier kann eine Liste von Filtern angegeben werden, d.h. NMEA
            Datensätze, die empfangen werden sollen. Wenn die Liste leer ist,
            werden alle Datensätze empfangen. Beispiel: RMC - nur $xxRMC
            Datensätze werden empfangen</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>log NMEA Data</td>
          <td>schreibe empfangene NMEA Daten in eine log Datei (im tracks
            Verzeichnis)</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>log AIS Data</td>
          <td>schreibe empfangene AIS Daten in eine log Datein</td>
          <td><br>
          </td>
        </tr>
        <tr>
          <td>filter NMEA logs</td>
          <td>ein Filter, welche NMEA Daten in das log geschrieben werden sollen</td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h3>Expert Settings</h3>
    <table style="width: 100%;" border="1">
      <tbody>
        <tr>
          <td>Name</td>
          <td>Bedeutung</td>
          <td>Default</td>
        </tr>
        <tr>
          <td>offset internal gps(s)</td>
          <td>Zeit offset für internes GPS in Sekunden</td>
          <td>0</td>
        </tr>
        <tr>
          <td>offset IP gps time(s)</td>
          <td>Zeit offset für IP GPS in Sekunden</td>
          <td>0</td>
        </tr>
        <tr>
          <td>offset bluetooth gps time(s)</td>
          <td>Zeit offset für bluetooth GPS in Sekunden</td>
          <td>0</td>
        </tr>
        <tr>
          <td style="height: 19px;">AIS info invalid after(s)</td>
          <td>Zeit, nach der ein AIS Ziel gelöscht wird in Sekunden</td>
          <td>1200</td>
        </tr>
        <tr>
          <td>min trackpoint distance(m)</td>
          <td>Schreibe einen trackpoint, wenn mindestens dieser Abstand zum
            letzten vorhanden ist</td>
          <td>25</td>
        </tr>
        <tr>
          <td>time between trackpoints(s)</td>
          <td>Schreibe einen neuen trackpoint frühestens n Sekunden nach dem
            letzten</td>
          <td>10</td>
        </tr>
        <tr>
          <td>write track file every (s)</td>
          <td>Schreibe das trackfile alle n Sekunden in das tracks Verzeichnis.
            Falls die app abstürzen sollte, sind so die Daten bis zu diesem
            Zeitpunkt gesichert. Die Trackdaten werden ausserdem beim Beenden
            geschrieben.</td>
          <td>300</td>
        </tr>
        <tr>
          <td>port for external browser mode</td>
          <td>Hier kann der durch den Webserver genutzte Port geändert werden.</td>
          <td>34567</td>
        </tr>
        <tr>
          <td>Sound for XXX alarm</td>
          <td>Hier kann der Ton für die verschiedenen Alarme gewählt werden</td>
          <td><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
  </body>
</html>
