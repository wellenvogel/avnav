<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Avnav Installation</title>
    <link href="styles.css" rel="stylesheet" type="text/css">
  </head>
  <body data-order="300">
    <h1 class="western">AvNav Installation</h1>
    <div class="toc"> </div>
    <h2> Releases </h2>
    <p>A description of the releases and download links can be found in the <a
        href="release.html">releases document</a>.</p>
    <p>If you are in a hurry - those are the <a href="https://www.free-x.de/raspbian/bullseye">current
        image</a>, the <a href="../downloads/daily">daily builds</a> and the <a
        href="../downloads/release">release downloads</a>.</p>
    <p>To provide a "ready to go" solution there are some images for the
      raspberry pi you can use. <br>
      Since version 20220421 the images do support both the "headless" working
      mode - i.e. no keyboard or monitor attached to the pi - as well as the
      "touch" mode - a monitor (with our without touch) is locally attached,
      optionally keyboard and mouse.</p>
    <p>AvNav is optimized for running on touch devices but you can use it on
      desktop systems with monitor, keyboard and mouse, too.</p>
    <p>So the usage of the images depend on your use case. For "headless" usage
      the Pi is only used as a server, the display logic will run in the browser
      e.g. on some mobile device. In this case a Raspberry Pi 3B(+) with 1GB
      should be sufficient. If you would like to run a local display you should
      go for a Pi4 with at least 2GB of memory. </p>
    <p>If you are looking for a complete desktop system with a lot of other
      applications <a href="#openplotter">OpenPlotter</a> could be your choice.
      For running OpenPlotter I suggest a Pi4 with 4GB of RAM. 2GB will do but
      without a lot of room for later extension requirements.</p>
    <p>In the past there were special AvNav Touch images. But they are not
      maintained any more.<br>
    </p>
    <h2><a name="Headless"></a><a name="headless"></a>AvNav Images (named
      Headless in the past)</h2>
    <p>Those images are maintained by <a href="https://www.segeln-forum.de/user/27970-blacksea/">BlackSea</a>
      (many thanks...). A description is available on<a href="https://github.com/free-x/avnav/wiki">
        his page</a>.<br>
      The images can be downloaded from&nbsp; <a href="https://www.free-x.de/raspbian/bullseye">free-x</a>
      and installed on a SD card as described at <a href="http://www.raspberrypi.org/downloads">http://www.raspberrypi.org/downloads</a>
      (raw images). <br>
      The images come with </p>
    <ul>
      <li>avnav</li>
      <li><a href="https://github.com/wellenvogel/avnav-update-plugin">avnav-update-plugin</a></li>
      <li><a href="hints/ocharts.html">avnav-ocharts-plugin</a></li>
      <li><a href="https://github.com/wellenvogel/avnav-mapproxy-plugin">avnav-mapproxy-plugin</a></li>
      <li><a href="https://github.com/wellenvogel/avnav-history-plugin">avnav-history-plugin</a></li>
      <li><a href="hints/CanboatAndSignalk.html">SignalK</a></li>
      <li><a href="hints/CanboatAndSignalk.html">Canboat</a></li>
      <li>Support for <a href="https://www.gedad.de/projekte/projekte-f%C3%BCr-privat/gedad-marine-control-server/">MCS</a></li>
      <li>optionally and X-Server with openbox and firefox in kiosk mode</li>
      <li>support for various <a href="#configHATS">HATs</a></li>
    </ul>
    They are preconfigured to route NMEA0183 traffic from all interfaces to
    AvNav and from there to <a href="hints/CanboatAndSignalk.html">SignalK</a>.
    AvNav will additionally fetch all data from SignalK and is able to display
    it.<br>
    NMEA2000 data will flow via Canboat to SignalK and in parallel to AvNav.<br>
    For details refer to <a href="hints/CanboatAndSignalk.html">CanBoatAndSignalK</a>.<br>
    <h3><a name="preparation"></a>Image Preparation</h3>
    <p>new as of 20210322, extended with 20220421</p>
    <p>Before inserting the SD card into your Raspberry (after you wrote the
      image to it) you should adapt a couple of settings (especially passwords).<br>
      The images hold a configuration file "avnav.conf" in the first partition
      of the SD card (boot partition). This file can be adapted using a text
      editor.<br>
      This is the place to configure whether you would like to run a local
      display ("touch variant").</p>
    <p>More easily you can use a simple GUI that is provided <a href="../configGen/index.html">here</a>.
    </p>
    <a href="../configGen/index.html"><img src="en_ConfigImagesUi.png" alt="" class="image"></a>
    <p>The meaning of the fields:</p>
    <table border="1" width="100%">
      <tbody>
        <tr>
          <td>name</td>
          <td>default</td>
          <td>description</td>
        </tr>
        <tr>
          <td style="width: 187px;">Wifi SSID</td>
          <td style="margin-left: 112px; width: 229px;">avnav</td>
          <td style="margin-left: 127px;">The name of the Wifi network created
            by the raspberry. The images are prepared to create multiple
            networks - if you e.g. decide to add an additional Wifi stick, the
            software will append a 1 digit number to this name</td>
        </tr>
        <tr>
          <td>Wifi Password</td>
          <td>avnav-secret</td>
          <td>The password for the Wifi network. In any case you should change
            this. Just keep in mind that everybody that can connect to this Wifi
            network is able to influence your navigation.</td>
        </tr>
        <tr>
          <td>User pi password</td>
          <td>raspberry</td>
          <td>This is the password for the user pi whenever you connect e.g.
            with ssh or by attaching a monitor and keyboard. Also change this
            one!</td>
        </tr>
        <tr>
          <td><a name="configBOARDS"></a>Base Board</td>
          <td>None</td>
          <td>You can select one&nbsp; of the supported base boards.<br>
            <ul>
              <li><b>MCS:</b> If this option is activated the software for the <a
                  href="https://www.gedad.de/projekte/projekte-f%C3%BCr-privat/gedad-marine-control-server/">Marine
                  Control Server from GeDad</a> will be activated.</li>
              <li><b>OBPPLOTTERV3:</b> This will set up the software for the <a
                  href="https://open-boat-projects.org/en/10-plotter-raspi-4b/">Open
                  Boat Projects Plotter (V3) </a>.</li>
            </ul>
          </td>
        </tr>
        <tr>
          <td><a name="configHATS"></a>HAT</td>
          <td>None</td>
          <td>You can select one of the supported HATs. AvNav will create the
            necessary entries for overlays in /boot/config.txt and will set up
            the can network interfaces.<br>
            <ul>
              <li>WAVESHAREB: <a href="https://www.waveshare.com/wiki/RS485_CAN_HAT_%28B%29">waveshare
                  RS485 CAN HAT (B)</a></li>
              <li>WAVESHAREA8: <a href="https://www.waveshare.com/wiki/RS485_CAN_HAT">waveshare
                  RS485 CAN HAT (8Mhz)<br>
                </a></li>
              <li>WAVESHAREA12: <a href="https://www.waveshare.com/wiki/RS485_CAN_HAT">waveshare
                  RS485 CAN HAT (12 Mhz)</a></li>
              <li>WAVESHARE2CH: <a href="https://www.waveshare.com/wiki/2-CH_CAN_HAT">waveshare
                  2CH CAN HAT</a></li>
              <li>PICANM: <a href="https://cdn.shopify.com/s/files/1/0563/2029/5107/files/pican-m_UGB_20.pdf?v=1619008196">PICAN-M</a></li>
              <li>MCARTHUR: <a href="https://github.com/OpenMarine/MacArthur-HAT">MacArthur
                  HAT</a></li>
            </ul>
          </td>
        </tr>
        <tr>
          <td><a name="configMODULES"></a>Module RTL8188EU</td>
          <td>off</td>
          <td>If activated the <a href="https://github.com/lwfinger/rtl8188eu/tree/v5.2.2.4">kernel
              driver module</a> for wifi adapters with the chip set RTL8188EU
            will be activated via <a href="https://manpages.debian.org/unstable/dkms/dkms.8.en.html">DKMS</a>
            .<br>
            If you would upgrade the kernel of your system (from the command
            line) the kernel module will be compiled to fit the newly installed
            kernel.</td>
        </tr>
        <tr>
          <td><a name="configMODULES"></a>Module RTL8192EU</td>
          <td>off</td>
          <td>If activated the <a href="https://github.com/Mange/rtl8192eu-linux-driver">kernel
              driver module</a> for wifi adapters with the chip set RTL8192EU
            will be activated via <a href="https://manpages.debian.org/unstable/dkms/dkms.8.en.html">DKMS</a>
            .<br>
            If you would upgrade the kernel of your system (from the command
            line) the kernel module will be compiled to fit the newly installed
            kernel.</td>
        </tr>
        <tr>
          <td>TimeZone</td>
          <td>Europe/Berlin</td>
          <td>The time zone that the image will use</td>
        </tr>
        <tr>
          <td>WifiCountry</td>
          <td>Germany</td>
          <td>Must be set for legal reasons before start using the Wifi adapter</td>
        </tr>
        <tr>
          <td>InternalWifi as Client</td>
          <td>off</td>
          <td>If switched on the internal Wifi adapter will not be configured as
            access point - instead you can use it to connect to other Wifi
            networks.<br>
            Remark: This requires some other way to connect to the Pi - as you
            need to configure the Wifi first.</td>
        </tr>
        <tr>
          <td>KeyboardLayout</td>
          <td>German</td>
          <td>The layout of a keyboard (including the X keyboard)</td>
        </tr>
        <tr>
          <td>KeyboardType</td>
          <td>Generic 105-key PC(intl.)</td>
          <td>Type of a connected keyboard</td>
        </tr>
        <tr>
          <td>TouchSupport<br>
            (since 20220421)</td>
          <td>off</td>
          <td>If enabled a local X server with firefox in kiosk mode is started
            - see <a href="#Touch">touch</a>.</td>
        </tr>
        <tr>
          <td>Display Dpi<br>
            (since 20220421)</td>
          <td>96</td>
          <td>Only if touch support is enabled.<br>
            Resolution of the connected screen (pixel/inch). A small calculator
            will come up to allow you to provide the screen dimensions in mm and
            in pixels.<br>
            This will scale some of the display elements on the connected
            monitor.</td>
        </tr>
        <tr>
          <td>OnScreen Keyboard Height (sind 20220421)</td>
          <td>7</td>
          <td>Only if touch support is enabled.<br>
            The height of a keyboard row of the on screen keyboard. Should be a
            compromis between the ability to touch the correct key and the
            occupied space.</td>
        </tr>
        <tr>
          <td>HideCursor<br>
            (sind 20220421)</td>
          <td>yes</td>
          <td>Only if touch support is enabled.<br>
            Will hide the cursor on the connected screen. Switch this off if you
            are going to use a mouse.</td>
        </tr>
      </tbody>
    </table>
    <p>After filling the values you need to click the download button and store
      the file avnav.conf into the first partition of your SD card (overwriting
      the existing example there!). To be able to do this, your SD card must be
      visible on your computer (on Windows you will only see the first
      partition). Potentially it could be necessary to eject, remove and
      reinsert the SD card after you have written the image before the card
      becomes visible.</p>
    <p>It would also be a a good idea to additionally backup the downloaded file
      at a safe place to be able to use it again whenever you need to create a
      new SD card.</p>
    <p>You can now insert the SD card into your raspberry and power it on. The
      first boot will take some time as it is rebooting once to enlarge the file
      system on your card. Depending on the selected configuration it will
      potentially reboot twice.</p>
    <p>Now you will be able to connect to your pi.</p>
    <h3><a name="connecting"></a><a name="access"></a>Connecting to your
      Raspberry Pi</h3>
    <p>If you configured a local monitor connecting is fairly easy of course.
      But for the headless mode (and as a fallback also recommended with local
      screen) the following options are available to connect to the Pi.</p>
    <ol>
      <li>with an&nbsp; ethernet cable<br>
        You could either connect to a router or point to point e.g. to a laptop</li>
      <li>via the internal wifi<br>
        By default the Pi will open up an access point with the SSID and
        password you have selected in the configuration. It will append a number
        to the SSID as it could create more access points if you would connect
        additional wifi adapters.</li>
      <li>via USB from an&nbsp; Android device<br>
        Modern Android devices mostly have an "USB-Tethering" function that will
        share the device wifi or mobile connection over USB. Unfortunately this
        typically is only available if your device has mobile support at all.</li>
      <li>Via a different wifi network<br>
        This requires a different connection initially as you need to configure
        the access. It also requires an additonal wifi adapter connected to the
        <a href="#connect-clientwifi">correct USB</a> socket. Optionally you
        could switch the internal Adapter to client mode in the configuration
        ("Internal Wifi as Client").</li>
    </ol>
    <p></p>
    <h4>Connection via Ethernet Cable</h4>
    <p>If you connect your pi to a router (e.g. in your home network) it will be
      assigned an IP address from there. You can connect to the Pi using this
      address.<br>
      Sometimes it is not that easy to find out this address - therefore the Pi
      will announce it's services via <a href="https://en.wikipedia.org/wiki/Multicast_DNS">mDNS</a>
      (Bonjour, Avahi).<br>
      Using mDNS it is simple to connect:</p>
    <div class="code">http://xxxx.local:8080</div>
    <p>xxx ist the hostname you have choosen in the configuration.<br>
      You can alos use this kind of address for an SSH connection(e.g. <a href="https://www.chiark.greenend.org.uk/%7Esgtatham/putty/">putty</a>).
      The access passowrd for the user pi has been set in the configuration.</p>
    <p>If you create a point to point connection with your network calble
      (without a router) the Pi will create an IP address by its own after some
      time. This could take 1...2 minutes. This IP will belong to the Automatic
      Private IP Addressing range 169.254.x.x. Most desktop systems will also
      support this (at linux you would potentially need to enable this
      explicitely).<br>
      If your laptop also created such an Ip on it's ethernet interface you
      should now be able to connect using the mDNS names xxx.local.</p>
    <p>If the access via xxx.lcal does not work you need to find out the IP of
      the Pi (e.g. using the admin UI of your router).</p>
    <h4><a name="connect-wifi"></a>Connection via the internal Wifi</h4>
    <p>You can use the Wifi network that the Pi has created. The SSID and the
      passwort had been set in avnav.conf.</p>
    <p> When being connected to the wifi network you still need to find out the
      address of the Pi. Like described for the ethernet access you should
      normally be able to use the mDNS address</p>
    <div class="code">http://xxx.local</div>
    <p>Ifthis does not work you can try with the fixed addresses 192.168.30.10,
      192.168.40.10, 192.168.50.10, 192.168.60.10:</p>
    <div class="code">http://192.168.30.10</div>
    <p><br>
    </p>
    <p>This should load the AvNav <a href="userdoc/index.html">mainpage</a>. It
      should also be possible to use xxxx.local for an SSH connection.(like <a
        href="https://www.putty.org/">putty</a> on Windows).<br>
    </p>
    <p>There is one restriction: Unfortunately xxx.local will not work on
      Android devices. I recommend installing a tool that is able to resolve
      mDNS-&nbsp;<a href="https://play.google.com/store/apps/details?id=de.wellenvogel.bonjourbrowser">
        BonjourBrowser </a>. For IOS there is a <a href="https://play.google.com/store/apps/details?id=de.wellenvogel.bonjourbrowser">similar
        tool</a> - although xxx.local should work there in the browser. You will
      find your Pi with the AvNav image with the name "avnav-server". Normally
      there will be a second entry "avnav" - this is <a href="hints/CanboatAndSignalk.html">SignalK</a>.<br>
      If you can see AvNav in the Bonjour Browser on Android but loading the
      page fails this could be caused by some strange network handling on
      Android. Sometimes it will help to disconnect mobile data.</p>
    <p>Since version 1.12 the Android BonjourBrowser will also support SSH
      services. The AvNav image (ab 20220421) also will announce it's SSH access
      via mDNS. If you installed a SSH client on Android (like <a href="https://play.google.com/store/apps/details?id=com.sonelli.juicessh&amp;hl=de&amp;gl=US">JuiceSSH</a>)
      you can also connect to the pi for an SSH session. This is maybe not that
      comfortable for normal operation - but could help for some repiar actions
      to issue commands.</p>
    The password has been set using the config file above. When connecting via
    ssh login with the user name pi. If your selected password does not work,
    try again with the default ('raspberry'). Potentially you did not store the
    avnav.conf correctly.<br>
    You can enter a root shell with sudo -i. <br>
    <h4><a name="connect-usb"></a>Connection from Android via USB</h4>
    <p>You need an Android device that supports USB Tethering (normally at
      connection settings). After you have connected your device via USB cable
      to the Pi switch on the USB Tethering (normally it will switch off again
      when you disconnect).<br>
      Beside the option to connect the Pi to the internet this way you can alos
      access AvNav or connect via SSH. As you need to know the IP I still
      recommend to install the <a href="https://play.google.com/store/apps/details?id=de.wellenvogel.bonjourbrowser">Bonjour
        Browser app</a> see at <a href="#connect-wifi">Wifi.</a> For SSH access
      again <a href="https://play.google.com/store/apps/details?id=com.sonelli.juicessh&amp;hl=de&amp;gl=US">JuiceSSH</a>.</p>
    <p>This is also an option to access the Pi if the Wifi does not work for
      some reason. In the BonjourBrowser you will find 2 http: addresses (port
      8080 for AvNav and port 3000 for SignalK). Additionally (since 20220421)
      the SSH access.</p>
    <h4><a name="connect-clientwifi"></a>Connection via a different Wifi Network</h4>
    <p>If you created (like described below) a wifi connection to another
      network you can enable the access to your Pi on this network ("external
      access" when you configure it).</p>
    <p>You should only allow this on a trusted network (e.g. the net of your own
      LTE router). <b>You should never enable this for a public network as
        there is no protection and everybody from within this network can access
        your Pi.</b></p>
    <p>The connection process is the same like described at&nbsp; <a href="#connect-wifi">Wifi
        connection.</a></p>
    <h3></h3>
    <p></p>
    <br>
    <h3>Connecting the Pi with the Internet</h3>
    <p>For some function (e.g. software updates) the Pi needs an internet
      connection. This is not necessary for the basic navigation functions, of
      course.</p>
    <p>Before the image version 20220421 you needed to consider that the Pi was
      not automatically setting it's local time without a connected GPS. This
      could lead to trouble for many internet connections.<br>
      Since version 20220421 the Pi will synchronize it's local time with the
      net (NTP) if there is no GPS.</p>
    <p>The following options are available to connect to the internet:</p>
    <ol>
      <li>Ethernet cable to a router</li>
      <li>Connection via a different wifi network</li>
      <li>Connecting via an Android device being connected on USB</li>
    </ol>
    <p>If the Pi has an internet connection it will share this to all devices
      connected to it's own wifi network.</p>
    <h4>Connection via Ethernet Cable</h4>
    <p>You will connect the Pi with an ether cable to a router.<br>
      There is nothing to be configured at the Pi.<br>
      On some Pi3 there is a chance that it will not detect the network if the
      cable was only connected after the boot. In this case just reboot the Pi
      with the cable connected.</p>
    <h4>Connection via a different Wifi Network</h4>
    <p>You need an additional wifi adapter (USB adapter). Please check the
      compatibility before buying one - e.g. <a href="https://elinux.org/RPi_USB_Wi-Fi_Adapters">here</a>.</p>
    <p>The stick must be plugged at the correct port (see picture). On the Pi4
      use the blue USB Port at the board side). <br>
      The internal name of the network will be wlan-av1.&nbsp; </p>
    <p></p>
    <p> <img class="fimage" src="raspi3-wlan.jpg"></p>
    <p>As an alternative you could set "InternalWifi as Client"&nbsp; in the
      image configuration. In this case the internal wifi adapter will not be
      used for an access point but will be avilable to connect to other
      networks. But you need a different way to connect to your Pi (e.g. cable
      or USB).</p>
    <p>The wifi connection can be configured in the AvNav <a href="userdoc/wpapage.html">App</a>.<br>
      For each network that you connect to you can select if you would allow
      access to your pi from this network("external access"). If you deselect
      it, the pi can access the internet on this network but nobody can access
      the Pi on it. Please not the <a href="#connect-clientwifi">Hints for
        access</a>.</p>
    <h4>Connection via and Android Device on USB</h4>
    <p>As described at <a href="#connect-usb">access</a> you can also utilize
      an Android device with USB tethering. Internally this will create a
      network interface usb0.<br>
      The Pi can use this interface to access the internet.</p>
    <p>This could be an easy option if you only need temporary internet access
      and don't have a (working) wifi stick.<br>
      If you have been connected to the internet a different way before (cable,
      wifi) it could happen that the pi will not immediately use the USB
      connection for the internet access. In this case just reboot (don't forget
      to re-enable USB tethering on the android device...).</p>
    <p><br>
    </p>
    <p> </p>
    <h3></h3>
    <h3>Technical Details<br>
    </h3>
    <p>The pi will set up one (or more) wifi networks using the internal adapter
      or additional wifi sticks. These networks will have addresses like
      192.168.20.0/24, 192.168.30.0/24, 192.168.40.0/24, 192.168.50.0/24. The pi
      itself has the address 192.168.x.10.</p>
    <p>There is a DHCP server and a DNS server (dnsmasqd). </p>
    <p>If the pi is connected to a wired network it tries to obtain an ip via
      DHCP. It has (NAT) forwarding from it's wifi to the wired network. This
      way you can easily connect to the internet if you are in the wifi network
      of the pi.<br>
      If you connect additional wifi sticks, more access points will be
      established.</p>
    For most actions ssh access to the pi is not required. To update you should
    use the preinstalled <a href="https://github.com/wellenvogel/avnav-update-plugin">Update
      Plugin</a> . The server configuration can now be accomplished within the
    AvNav app - at the <a href="userdoc/statuspage.html">Server/Status</a>
    page.
    <h2><a name="Touch"></a>Image with Display (AvNav touch)</h2>
    <p> <span>In previous versions there has been a separate AvNav Touch image.</span><br>
      This is not maintained any more.<br>
      Since version 20220421 the support for a connected monitor (focus on
      touch) has been integrated into the "normal" AvNav images.</p>
    <p>As described at <a href="#preparation">Preparation</a> you can switch on
      the support for a local monitor there.</p>
    <p>If you enable this the system will start up a service "avnav-startx".
      This service creates a local X server, a user session for the user pi with
      <a href="http://openbox.org/wiki/Main_Page">openbox</a> as window manager
      and firefox in kiosk mode.</p>
    <p><a href="http://manpages.ubuntu.com/manpages/bionic/man1/onboard.1.html">Onboard</a>
      will be used for an on screen keyboard.</p>
    <p>On the AvNav mainpage (and on some other pages) there will be a
      "raspberry" button that will bring up a second virtual screen that
      contains a file manager, a terminal and some other applications.<br>
      Intentionally the system has not been set up as a complete desktop system
      to save resources.</p>
    <p>As you can only reach the system tools via the button inside the AvNav
      app it is recommended to additionally prepare one of the other options to
      access your system to be able to repair.<br>
      To restart the local UI from the command line use</p>
    <div class="code">sudo systemctl restart avnav-startx</div>
    <br>
    <p>If Firefox fails to start due to some problems with it's profile data you
      can just remove it. On the next restart it will be recreated.<br>
      <b>Important</b>: AvNav settings that not have been saved to the server
      will be lost in this case.</p>
    <div class="code">sudo systemctl stop avnav-startx<br>rm -rf /home/pi/.mozilla/firefox/avnav<br>sudo systemctl start avnav-startx</div>
    <p>Since version 20230614 the main screen will show an additonal panel every
      time AvNav has not (or not completely) loaded.</p>
    <p><img src="xui-ffpanel.png" alt="" class="fimage"><br>
    </p>
    <p>Using this panel you will get some basic firefox navigation functions and
      you can switch to the second (system) screen. Additionally you can execute
      the reset function for the firefox profile described above (<img src="viewerimages/SailBoatRed96.png"
        alt="" class="inlineimage">).</p>
    <p>This will help to operate the system even if AvNav does not start up
      completely. For new installations you will also find the reset function on
      the second screen.</p>
    <h2 class="western"><a name="Packages"></a>Package Installation</h2>
    <h3>Repositories<br>
    </h3>
    <p>Thanks to Oleg there are ready to go package repositories you can use in
      your debian based system. This will work on the pi as well as on any other
      debian (like ubuntu).</p>
    Information is available at his github <a href="https://github.com/free-x/avnav/wiki">wiki</a>.
    <p>To set up the repository on your system, run the following commands (only
      required if you don't use the headless or the AvNav touch images):</p>
    <p></p>
    <p> Debian Buster (amd64,armhf,arm64)</p>
    <div class="code">wget https://www.free-x.de/debian/oss.boating.gpg.key
sudo apt-key add oss.boating.gpg.key
wget https://www.free-x.de/debian/boating-buster.list
sudo cp boating-buster.list /etc/apt/sources.list.d/</div>
    <p> Debian Bullseye (amd64,armhf,arm64)</p>
    <div class="code">wget -O - https://www.free-x.de/debian/oss.boating.gpg.key | gpg --dearmor | sudo tee /usr/share/keyrings/oss.boating.gpg
echo "deb [signed-by=/usr/share/keyrings/oss.boating.gpg] https://www.free-x.de/debian bullseye main contrib non-free" | sudo tee -a /etc/apt/sources.list.d/boating.list</div>
    <p> Ubuntu Jammy (amd64)</p>
    <div class="code">wget -O - https://www.free-x.de/ubuntu/oss.boating.gpg.key | gpg --dearmor | sudo tee /usr/share/keyrings/oss.boating.gpg
echo "deb [signed-by=/usr/share/keyrings/oss.boating.gpg] https://www.free-x.de/ubuntu jammy main" | sudo tee -a /etc/apt/sources.list.d/boating.list</div>
    For the installation on a linux system you need to execute:
    <div class="code">sudo apt update
sudo apt install avnav </div>
    <h3>Startup</h3>
    Afterwards you can start up avnav (as every user) from the commandline<br>
    <div class="code">avnav</div>
    (Note: this will only start the server part, you need to use a browser to
    connect to it - port 8080).<br>
    With<br>
    <div class="code">sudo systemctl enable avnav
sudo systemctl start avnav</div>
    <p> you can let AvNav start with the user "avnav" automatically on system
      start up.</p>
    <h3>User Service</h3>
    <p><a name="userservice"></a>Starting from 20240520 you can run AvNav as a <a
        href="https://wiki.archlinux.org/title/Systemd/User">user systemd
        service</a> for your user. To enable this you need to run</p>
    <div class="code">avnavservice enable [port]</div>
    <p>This will enable a user systemd service "avnav" that will automatically
      start when the user logs in and stop when the user logs out. To have the
      service running even when the user is not logged in you can set the
      "linger" mode for the user:</p>
    <div class="code">loginctl enable-linger</div>
    <p>For details refer to the <a href="https://wiki.archlinux.org/title/Systemd/User">systemd
        documentation</a>.</p>
    <p>To check the status of the running service use</p>
    <div class="code">systemctl --user status avnav</div>
    <p>AvNav will use the default data directory at $HOME/avnav to put it's data
      there.</p>
    <p>To disable the service again use</p>
    <div class="code">avnavservice disable</div>
    <h3>Download</h3>
    <p>Alternatively you can download all packages from my download pages:</p>
    <ul>
      <li><a title="downloads/releases" href="../downloads/release">Releases</a></li>
      <li><a href="../downloads/daily">Daily Builds</a></li>
    </ul>
    <p>After downloading you can install with<br>
    </p>
    <div class="code">sudo apt install ./avnav_xxxxxxxx_all.deb
</div><br>
    <p>If you would like to set up your raspberry like we build our images you
      can additionally install the "avnav-raspi" packages.<br>
      This will change the network configuration, will create a start
      configuration for AvNav with the user pi and will enable setting the
      system time and managing client networks.<br>
      <b>Hint</b>: This can easily conflict with the settings of your base
      system - so please use with care.<br>
      <br>
      In any case you should additionally install the <a href="https://github.com/wellenvogel/avnav-update-plugin">AvNav
        Update-Plugin</a> with </p>
    <div class="code">sudo apt-get install avnav-update-plugin</div>
    <p>or by direct download from&nbsp; <a href="https://github.com/wellenvogel/avnav-update-plugin">GitHub.</a><br>
      <b>Remark</b>: The start and stop functions of the update plugin do not
      (yet) work with avnav services created as a systemd user service - but you
      can easily restart AvNav from within the app.</p>
    <p>If you did not install the "avnav-raspi" package but you still want to
      auto start AvNav with a different user then avnav you should use the
      systemd user handling described above.</p>
    <p>As an alternative you could create a service override - example for the
      user pi:</p>
    Create /usr/lib/systemd/system/avnav.service.d and create a file avnav.conf
    in this directory with the following content:
    <div class="code">
#Overrides for the avnav service
[Service]
User=pi
ExecStart=
ExecStart=/usr/bin/avnav -q -b /home/pi/avnav/data -t /usr/lib/avnav/avnav_template.xml -n /etc/default/avnav

[Unit]
After=avnav-check-parts.service
    </div>
    Afterwards you can enable and start avnav as system service with<br>
    <div class="code">sudo systemctl daemon-reload<br>sudo systemctl enable avnav
sudo systemctl start avnav</div>
    <p>If you did not create this file avnav will not run as user pi but as user
      avnav.</p>
    <h2><a name="openplotter"></a>OpenPlotter</h2>
    <p>For <a href="https://openmarine.net/openplotter">OpenPlotter</a> we have
      a complete integration for AvNav (thanks to <a href="https://github.com/e-sailing">e-sailing</a>).
      In the repository <a href="https://www.free-x.de/deb4op/">https://www.free-x.de/deb4op/</a>
      (that is already active in OpenPlotter) the necessary packages are already
      available. So you can install them simply with</p>
    <div class="code">sudo apt update
sudo apt install openplotter-avnav</div>
    <p> </p>
    <p>Since 2021/03 AvNav is already officially available in OpenPlotter. Sou
      if you update OpenPlotter you should already have openplotter-avnav being
      included.</p>
    <p>Do not install avnav-raspi_xxx.deb on OpenPlotter as this will interfere
      with the OpenPlotter network configuration. Within the OpenPlotter AvNav
      configuration you can change the port for AvNav (default 8080 and 8082 for
      ocharts) if this conflicts with other applications.</p>
    <p>When installing AvNav this way it will receive all NMEA data from SignalK
      (and will not open up any USB devices on its own). So you can make any
      interface configuration changes in OpenPlotter or SignalK.</p>
    <p><br>
    </p>
    <h2><a name="Windows"></a>Windows</h2>
    <p> For Windows there is an installer (new from 20240520). The current
      version is available for download <a href="../downloads/release/latest/avnav-service-latest.exe">here</a>.
      This installer will create an app "avnavservice" that (by default) is
      started automatically for you (User autostart). This service creates an
      icon in the notification area that can bring up a menu to handle
      installation, update start and stop of avnav. This small service does not
      yet include the AvNav software itself (or the necessary python
      installation). But from the menu you can trigger this installation.<br>
      For deinstallation use the normal way (ControlPanel/Software). </p>
    <p><img src="windows-notification-1.png" alt=""></p>
    <p><img src="windows-notification-2.png" alt=""></p>
    <p>The service Menu has the following entries:</p>
    <table border="1" width="100%">
      <tbody>
        <tr>
          <td>Caption</td>
          <td>Function</td>
        </tr>
        <tr>
          <td>Start</td>
          <td>Start the avnav server. Only available if the avnav software is
            installed and avnav ist not running. The service will remember the
            last start action - so if you later restart and AvNav was running
            before it will automatically be started again.</td>
        </tr>
        <tr>
          <td>Stop</td>
          <td>Stop the AvNav server.</td>
        </tr>
        <tr>
          <td>Open</td>
          <td>Open the default browser and connect to the AvNav server.</td>
        </tr>
        <tr>
          <td>Logs</td>
          <td>Open an explorer in the AvNav log directory
            (PROFILEDIR/AvNav/logs). There is the normal avnav.log and
            additionally the outputs from the startup (service-err.log).<br>
            To reach the AvNav config file you can simply navigate one directory
            up in the explorer.</td>
        </tr>
        <tr>
          <td>Config</td>
          <td>Allow to set the used HTTP Port (default: 8080)</td>
        </tr>
        <tr>
          <td>Update</td>
          <td>This will be "Install" if the AvNav software is not installed yet.
            <br>
            It will bring up an install dialog (see below)</td>
        </tr>
        <tr>
          <td>Remove</td>
          <td>This will remove the installed AvNav software (but all your data
            at PROFILEDIR/AvNav will be kept).<br>
            Before deinstalling the avnavservice (via system control/software)
            you should use this "Remove".<br>
            Otherwise you need to clean up PROFILEDIR/AppData/Local/avnav later
            on by hand.</td>
        </tr>
        <tr>
          <td>Exit</td>
          <td>Stop AvNav and exit the avnavservice (the system notification will
            go away). You can start the service again via the start menu.<br>
            Normally you can leave avnavservice up and running. As long as the
            AvNav server is stopped it will consume only very few resources.<br>
            Only after an installation of avnavservice itself you need to stop
            and start it.</td>
        </tr>
      </tbody>
    </table>
    <h3><a name="windowsinstall"></a>Installation</h3>
    <p>After clicking the Install/Update menu a small dialog will be brought up.</p>
    <p><img src="windows-install-1.png" alt=""></p>
    The url provided here is the default installation url for the latest AvNav
    software. But you can input any URL that points to a valid avnav software
    package - e.g. from the <a href="../downloads/daily">daily</a> or <a href="../downloads/release">release</a>
    pages. <br>
    <p>After clicking OK an installation window will pop up and show you the
      installation progress.</p>
    <p><img src="windows-install-2.png" alt="" class="fimage image"></p>
    After you close this window you can start the AvNav software again in the
    menu.<br>
    <h3>Windows Hints</h3>
    <p>The avnavservice requires Powershell (&gt;= 5.x) - that should be
      available on all modern windows systems. If the installation later on
      fails there is a chance that the system misses the latest C/C++ libraries.
      In this case download them from <a href="https://learn.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft</a>.
      The direct link normally is <a href="https://aka.ms/vs/17/release/vc_redist.x64.exe">here</a>.
    </p>
    <p>This new windows installation replaces the old AvNavNetSetup with an on
      GUI. Releases starting from 20240520 will not be compatible with the old
      installation. It is recommended to completely remove any old installation
      before using this new installer.</p>
    <p>The chart conversion functionality is now fully integrated in AvNav any
      way and can be used as described in the App Documentation.<br>
      Additionally you can use devices connected to your windows system in the
      normal way (e.g. a GPS stick).</p>
    <p>As the AvNav server is running in the background you can also use it
      easily as a NMEA multiplexer and logger. </p>
    <br>
    <br>
  </body>
</html>
